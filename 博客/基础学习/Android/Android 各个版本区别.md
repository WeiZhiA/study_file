Android 各个版本区别

# 1.Android 4.0
1.引入ARt(Android Runtime)虚拟机，但是默认未启用。

# 2.Android 5.0
1.使用Art虚拟机(运行时)替代Dalvik虚拟机（实时编译）
2.引入Material Design（材料设计），提供扩充的UI工具包

# 3.Android 6.0
1.运行时权限（动态权限）
 * 对于一些危险的权限，还要再清单文件中申请，例如：联系人权限，读写权限，摄像头权限
2.指纹识别
3.电量管理（Doze休眠机制）
* 手机长时间未使用时，清理后台应用程序，减少电量消耗

# 4.Android 7.0
1.分屏多任务
2.优化Doze休眠机制
3.应用间共享文件，需要使用 FileProvider 类；或者content:// URI，并授予 URI 临时访问权限。而不是使用旧的

# 5.Android 8.0
1.画中画
2.对广播进行了限制
* 静态注册的广播接收器无法接收到隐式广播，但是能接收到显式广播，动态注册的广播接收器可以接收任意广播

隐式Intent：不会指定特定的组件，而是声明要执行的常规操作，从而允许其他应用中的组件来处理它。如 Intent intent = new Intent(Intent.ACTION_VIEW)；如需在地图上向用户显示位置，则可以使用隐式Intent，请求另一具有此功能的应用在地图上显示指定的位置

显式Intent：按名称（完全限定类名）指定到启动的组件。如 Intent intent = new Intent(this, MyReceive.class)，通常，在自己的应用中使用显式Intent来启动组件，这是因为知道要启动的Activity或服务的类名。例如，启动新Activity以响应用户操作，或者启动服务以在后台下载

2.自适应图标 — Adaptive Icons

# 6.Android 9.0
1.所有应用程序默认都使用HTTPS
2.多摄像头支持

# 7.Android 10
1.禁止后台拉起activity
2.无法获取设备标识符(deviceId)
3.黑夜模式

# 8.Android 11
1.包可见性
APP可以获取到手机已安装的应用列表信息，如果想要获取获取某个app是否安装，需要在清单文件中配置对应的包名。例如添加部分导航 APP 的包名、加入拨打电话的 Intent。

2.限制更多的唯一标识符
Android 10限制了对 IMEI 的获取。  
Mac 地址和 ICCID 的获取都受限了。  

3.申请权限时，增加了仅本次运行。针对麦克风，相机。

4.必须使用v2签名

3.分区存储
1）内置存储里的应用私有目录
2）外置存储里的应用私有目录
3）外置存储里的媒体文件
4）外置存储里的文件

在分区存储开启之后，将受到以下限制：
•	私有目录访问权限不变
•	可以直接访问本应用共享的媒体文件
•	可以申请权限访问其他应用共享的媒体文件
•	可以在弹窗确认后修改或删除其他应用共享的媒体文件
•	外置存储的非媒体文件不能直接访问
•	外置存储的文件可以通过SAF (Storage Access Framework) 访问
•	
私有目录不用修改，媒体目录需要适配，非媒体目录不能直接访问。


12.改动不大

1.android:exported
它主要是设置 Activity 是否可由其他应用的组件启动」， “true” 则表示可以，而“false”表示不可以。

2.SplashScreen
如果你什么都不做，那 App 的 Launcher 图标会变成 SplashScreen 界面的那个图标，而对应的原主题下 windowBackground 属性指定的颜色，就会成为 SplashScreen 界面的背景颜色。「这个启动效果在所有应用的冷启动和热启动期间会出现。」


# 补充

## 1.Art虚拟机

1.安装时，预编译成原生代码，之后在运行的时候效率更高。Delvik是一边解释，一边运行。
及时翻译(动态翻译)Just-In-Time (JIT )编译器去解释字节码。  
Ahead-Of-Time (AOT）编译，应用安装时就预编译字节码到机器语言。

缺点：
1、更大的存储空间占用，可能会增加10%-20%。
2、更长的应用安装时间。

ART优点：
1、系统性能的显著提升。
2、应用启动更快、运行更快、体验更流畅、触感反馈更及时。
3、更长的电池续航能力。
4、支持更低的硬件。



2.优化GC(回收机制)机制，

旧的
1、当gc被触发时候,其会去查找所有活动的对象,这个时候整个程序与虚拟机内部的所有线程就会挂起

新的
1、GC将会锁住Java堆,扫描并进行标记
2、标记完毕释放掉Java堆的锁,并且挂起所有线程
3、GC对标记的对象进行回收
4、恢复所有线程的执行现场继续运行
5、重复2-4直到结束

3.提高内存使用，减少碎片化

将不连续的物理内存块进行对齐

## 65535

原因：
加载dex文件时，为了方便查找，会将类和方法用id关联起来，并将id存放在数组中，数组长度是short类型，也就是长度为65536。一般来说，方法比类要多，所有方法最先超过65536个
